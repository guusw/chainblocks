#!/bin/bash

source $(dirname ${BASH_SOURCE[0]})/../shared

EMSCRIPTEN_PTHREADS=${EMSCRIPTEN_PTHREADS:-OFF}

mkdir -p ${CHAINBLOCKS_BUILD_PATH}
source ${EMSDK}/emsdk_env.sh
cmake -B ${CHAINBLOCKS_BUILD_PATH} -S ${CHAINBLOCKS_ROOT_PATH} -GNinja -DCMAKE_BUILD_TYPE=Release -DBOOST_ROOT=${CHAINBLOCKS_ROOT_PATH}/external/boost_1_76_0 -DSKIP_HEAVY_INLINE=1 -DUSE_LTO=1 -DRust_USE_LTO=0 -DEMSCRIPTEN_PTHREADS=${EMSCRIPTEN_PTHREADS} -DCMAKE_TOOLCHAIN_FILE=${EMSDK}/upstream/emscripten/cmake/Modules/Platform/Emscripten.cmake
